{% extends "base.html" %}

{% load static %}

{% block scripts %}
    {# below is the CSS and JS for leaflet the map tool we use #}
     <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
      {# the below js file should stay below the css file for leaflet #}
 <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>


{% endblock %}

{%block page_title%}Strike on {{strike.date}} at {{strike.location}}{%endblock%}


{%block page_heading%}{{strike.date}} <span class="text-amber-400">|</span> {{strike.location_label}}{%endblock%}

{%block main_content%}
              <aside class="w-72 border-r border-white/10 bg-white/[0.03]">
            <div class="p-5">
              <!-- Sidebar search -->
              <div class="relative">
                <span class="pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400">
                  <!-- magnifier -->
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    class="h-4 w-4"
                    stroke-width="2"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      d="M21 21l-4.3-4.3m1.8-5.2a7 7 0 11-14 0 7 7 0 0114 0z"
                    />
                  </svg>
                </span>
                <input
                  type="text"
                  placeholder="Search"
                  class="w-full rounded-xl border border-white/10 bg-white/5 py-2.5 pl-10 pr-3 text-sm text-zinc-100 placeholder:text-zinc-500 outline-none ring-0 focus:border-white/20 focus:bg-white/7"
                />
              </div>
            </div>

            <!-- Strike list -->
            <div class="px-3 pb-6">
              <ul class="space-y-2">
                <!-- Item (active) -->
                 {% for strike in all_strikes %}
                <li>
                  <a href="/dashboard/{{strike.pk}}">
                  <button
                    class="group flex w-full items-center justify-between rounded-xl border border-white/10 bg-white/5 px-3 py-3 text-left shadow-sm transition hover:bg-white/7"
                  >
                    <div class="flex items-center gap-3">
                      <span
                        class="grid h-5 w-5 place-items-center rounded-md bg-amber-500/90 text-zinc-950"
                        aria-hidden="true"
                      >
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          class="h-4 w-4"
                          stroke-width="3"
                        >
                          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                        </svg>
                      </span>

                      <div class="leading-tight">
                        <div class="text-sm font-medium">{{strike.date}}</div>
                        <div class="text-xs text-zinc-500">Strike Id:{{strike.pk}}</div>
                      </div>
                    </div>

                    <span class="h-4 w-4 rounded-full border-2 border-amber-500/90"></span>
                  </button>
                  </a>
                </li>
                {% endfor %}
              </ul>
            </div>
          </aside>
                    <main class="flex-1 bg-gradient-to-b from-white/[0.02] to-transparent">
            <div class="p-6">
              <!-- Top grid -->
              <div class="grid grid-cols-12 gap-6">
                <!-- Table card -->
                <section
                  class="col-span-12 lg:col-span-6 rounded-2xl border border-white/10 bg-white/[0.03] shadow-xl shadow-black/30"
                >
                  <div class="p-6">

                    <div class="overflow-hidden rounded-xl border border-white/10">
                      <table class="w-full text-sm">
                        <tbody class="divide-y divide-white/10">
                          <tr class="bg-white/[0.02]">
                            <td class="w-1/2 px-4 py-3 text-zinc-200">Target</td>
                            <td class="w-1/2 px-4 py-3 text-right text-zinc-300">{{ strike.target }}</td>
                          </tr>
                          <tr>
                            <td class="px-4 py-3 text-zinc-200">Striker</td>
                            <td class="px-4 py-3 text-right text-zinc-300">{{strike.striker}}</td>
                          </tr>
                          <tr>
                            <td class="px-4 py-3 text-zinc-200">Target Origin</td>
                            <td class="px-4 py-3 text-right text-zinc-400">
                              {% if strike.target_origin %}
                               {{strike.target_origin}}
                              {%else%}
                              Needs Source
                              {%endif%}
                            </td>
                          </tr>
                          <tr>
                            <td class="px-4 py-3 text-zinc-200">Destination</td>
                            <td class="px-4 py-3 text-right text-zinc-400">
                              {% if strike.destination %}
                               {{strike.destination}}
                              {%else%}
                              Needs Source
                              {%endif%}
                            </td>
                          </tr>
                          <tr>
                            <td class="px-4 py-3 text-zinc-200">Crew Number</td>
                            <td class="px-4 py-3 text-right text-zinc-400">
                              {% if strike.crew_number %}
                               {{strike.crew_number}}
                              {%else%}
                              Needs Source
                              {%endif%}
                            </td>
                          </tr>
                          <tr>
                            <td class="px-4 py-3 text-zinc-200">Number Killed</td>
                            <td class="px-4 py-3 text-right text-cyan-200">{{strike.number_killed}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>

                    <div class="mt-5">
                      <button
                        class="inline-flex items-center gap-3 rounded-xl border border-white/10 bg-white/5 px-4 py-2.5 text-sm font-medium text-zinc-100 shadow-sm transition hover:bg-white/7"
                      >
                        View Sources
                        <span class="text-cyan-300">
                          <svg
                            xmlns="http://www.w3.org/2000/svg"
                            viewBox="0 0 24 24"
                            fill="none"
                            stroke="currentColor"
                            class="h-4 w-4"
                            stroke-width="2.5"
                          >
                            <path stroke-linecap="round" stroke-linejoin="round" d="M9 18l6-6-6-6" />
                          </svg>
                        </span>
                      </button>
                    </div>
                  </div>
                </section>

                <!-- Map card -->
<section
  class="col-span-12 lg:col-span-6 overflow-hidden rounded-2xl border border-white/10 bg-white/[0.03] shadow-xl shadow-black/30 flex flex-col"
>
  <div
    id="strike_map"
    {% if strike.location_lat and strike.location_lon %}
      data-lat="{{ strike.location_lat }}"
      data-lon="{{ strike.location_lon }}"
    {% endif %}
    class="relative h-80 lg:h-full flex-1"
  ></div>

  <div class="border-t border-white/10 bg-black/20 px-4 py-2 text-sm text-zinc-200">
    {{ strike.location_label }}
  </div>

  {% if not strike.location_lat or not strike.location_lon %}
    <p class="px-4 pb-4 text-sm text-zinc-400">
      No map data is available. To submit location data, click on the submit button at the bottom of the page.
    </p>
  {% endif %}
</section>

                <!-- Video card -->
                <section
                  class="col-span-12 lg:col-span-6 overflow-hidden rounded-2xl border border-white/10 bg-white/[0.03] shadow-xl shadow-black/30"
                >
                {% if strike.dvids_video_id %}
                  <div class="relative aspect-[16/9] bg-zinc-900">
                    
                    <iframe class="absolute inset-0 h-full w-full"
  src="https://www.dvidshub.net/video/embed/{{strike.dvids_video_id}}"
  width="800"
  height="450"
  frameborder="0"
  allowfullscreen
></iframe>

                  </div>
                  {% else %}
                  <p class="px-4 pb-4 text-sm text-zinc-400">No footage is available. To submit footage, click on the submit button at the bottom of the page.</p>
                  {% endif %}
                </section>

                <!-- Image card -->
                <section
                  class="col-span-12 lg:col-span-6 overflow-hidden rounded-2xl border border-white/10 bg-white/[0.03] shadow-xl shadow-black/30"
                >
                {% if strike.image_url %}
                  <div class="relative aspect-[16/9] bg-zinc-900">
                    <!-- Placeholder "image" -->
                    <div class="absolute inset-0 bg-[radial-gradient(circle_at_35%_35%,rgba(255,255,255,0.10),transparent_55%),radial-gradient(circle_at_70%_70%,rgba(34,211,238,0.10),transparent_55%),linear-gradient(to_bottom,rgba(255,255,255,0.02),transparent)]"></div>
                    <div
                      class="absolute inset-0 opacity-25"
                      style="background-image: linear-gradient(to bottom, transparent, rgba(0, 0, 0, 0.55));"
                    ></div>
                  </div>
                </section>
                {% else %}
                <p class="px-4 pb-4 text-sm text-zinc-400">No image is available. To submit an image, click on the submit button at the bottom of the page.</p>
                {% endif %}
              </div>
            </div>
          </main>
{%endblock%}
{% block bottom_scripts %}
<script src="{% static 'dashboard/js/strikes.js' %}"></script>
{% endblock %}